{% extends "base.html" %}

{% block title %}
  {{ resourceNames.0 }} &ndash; META-SHARE
{% endblock %}

{% block links %}
<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}css/resource_view.css" />
{% endblock %}

{% block description %}
  {% for item in descriptions %}
    {{ item|truncatewords:20}}...
  {% endfor %}
{% endblock %}

{% block keywords %}
  {# here, we should put resource type, media type, linguality type, licence, availability. #}
  {{ resourceType }}, {{ mediaTypes|join:", " }}, {{ lingualityType }}, {{ availabilities|join:", " }}, {{ licences|join:", " }}
{% endblock %}


{% block content %}
		<script type="text/javascript" src="http://plugins.learningjquery.com/expander/jquery.expander.js"></script>
		<script type="text/javascript">
			$(function () {
				$('.readmore').expander({
					slicePoint: 300,
					expandText: 'Read More',
					userCollapseText: 'Read Less'
				});
			});
		</script>

		<script type="text/javascript">
			function getElementsByClassName(node,classname)
			{
				if (node.getElementsByClassName)
					{return node.getElementsByClassName(classname);}
			}
			function getElementsByClass(searchClass,node,tag)
			{
				var classElements = new Array();
				if ( node == null ){node = document;}
				if ( tag == null ){tag = '*';}
				var els = node.getElementsByTagName(tag);
				var elsLen = els.length;
				var pattern = new indexOf(searchClass);
				for (i = 0, j = 0; i < elsLen; i++)
				{
				if ( pattern.test(els[i].className) )
					{
					classElements[j] = els[i];
					j++;
					}
				}
				return classElements;
			}
			function toggle(el)
			{
				if (el.style.display == '')
					{
					el.style.display = 'none';
					}
					else
					{
					el.style.display = '';
					}
			}
			function displayMandatory()
			{
				var els = getElementsByClassName(document, 'mandatory');
				var i;
				for (i = 0; i < els.length; i += 1) 
				{
					toggle(els[i]);
				}
			}
			function displayOptional()
			{
				var els = getElementsByClassName(document, 'optional');
				var i;
				for (i = 0; i < els.length; i += 1) 
				{
					toggle(els[i]);
				}
			}
		</script>
		
		<script>
			$(document).ready(function(){  
				$(".tab_content").hide();
				$(".fields li:first-child").addClass("active");
				var selected_tab = $(".fields li.active").find("a").attr("href");
				$(selected_tab).fadeIn();
				$(".fields li").click(function() {
					$(".fields li").removeClass("active");
					$(this).addClass("active");
					$(".tab_content").hide();
					var selected_tab = $(this).find("a").attr("href");
					$(selected_tab).fadeIn();
					return false;
		  		});		  		
			});
		</script>


		<style type="text/css">
			div#content dummy, span.details {
				font: inherit;
				color: inherit;
				vertical-align: inherit;
			 }
		</style>
		
		
	<div class="top_box white_box">
		<div id="stats" align="right">
            {% for stat in LR_STATS %}
                {%if "updated" in stat.action %}
                    &nbsp;<div align=right style="float: right"><i>(Last modified: {{ stat.last }})</i>&nbsp;</div>
                {% else %}
                	<a href="#" class="tip">
                    <img src="{{ MEDIA_URL }}stats/img/{{ stat.action }}_icon.gif"
                    alt="Last {{ stat.action }}: {{ stat.last }}"/>
                    <span>Last {{ stat.action }}: {{ stat.last }}</span>
                    </a>
                    <b>{{  stat.count }}</b>&nbsp;
                {% endif %}
            {% endfor %}
        </div>
        
		<h2>{{ resourceNames.0 }}</h2>
		<h3>{% for name in resourceShortNames %}{{ name }}<img src="{{ MEDIA_URL }}images/trenner.png" class="trenner" />{% endfor %}</h3> {# Here we should choose the english version of resource short name (should be provided by views.py) #}
		<h4 style="text-align:justify" class="readmore">{{ descriptions.0 }}</h4>
		{% if url.0 %}
		<h4><a href="{{url.0}}" target="_blank">{{url.0}}</a></h4>
		{% endif %}
	
	
	</div>
	
		<div class="white_box column corner readmore">
			{% include "repository/detailed_component.html" with lr_content=distribution_info_tuple %}
			{% include "repository/detailed_component.html" with lr_content=resource_creation_info_tuple %}
			{% if relation_info_tuple %}
			{% include "repository/detailed_component.html" with lr_content=relation_info_tuple %}
			{% endif %}
			
		</div>
		
		<div class="column middle">
			<div class="fields">
					<ul>
						{% for type in mediaTypes %}
							<li><a href="#{{forloop.counter}}">{{type}}</a></li>
						{% endfor %}
					</ul>
				</div>
			<div class="white_box middle_box">
				
			{% for type in mediaTypes %}
				<div id="tabs_content_container">
					<div id="{{forloop.counter}}" class="tab_content">
						{% ifequal type "text" %}
							{% include "repository/corpus_text_info.html" %}
						{% endifequal %}
						{% ifequal type "audio" %}
							{% include "repository/corpus_audio_info.html" %}
						{% endifequal %}
						{% ifequal type "video" %}
							{% include "repository/corpus_video_info.html" %}
						{% endifequal %}
						{% ifequal type "image" %}
							{% include "repository/corpus_image_info.html" %}
						{% endifequal %}
						{% ifequal type "textNumerical" %}
							{% include "repository/corpus_textNumerical_info.html" %}
						{% endifequal %}
						{% ifequal type "textNgram" %}
							{% include "repository/corpus_textNgram_info.html" %}
						{% endifequal %}
						
					</div>
				</div>
			{% endfor %}
			</div>
		</div>
		<div class="white_box column corner right-corner">
			{% include "repository/detailed_component.html" with lr_content=metadata_info_tuple %}
		</div>


	<div class='bottom_box'>
        
  <a href="javascript:history.back();"><button class="span-12 button middle_button">&laquo; Back</button></a>
  {% if LR_DOWNLOAD %}
    <a href="{% url metashare.repository.views.download resource.storage_object.identifier %}"><button class="span-4 button middle_button">Download</button></a>
  {% else %}
    <div class="popup_box">
      <div onmouseover="$(this).siblings('div.popup').show();" onmouseout="$(this).siblings('div.popup').hide();"><button class="span-4 button middle_gray_button">Download</button></div><div class="popup" style="height:50px; left:190px; width:270px; top:50px;"><img style="left:10px;" src="{{ MEDIA_URL }}images/adv_search_pfeil.png" />&nbsp;You don&rsquo;t have the permission to download this resource. Please log in.</div>
    </div>
  {% endif %}
  {% if LR_EDIT %}
    <a href="{{ LR_EDIT }}"><button class="span-4 button middle_button">Edit Resource</button></a>
  {% else %}
    <div onmouseover="$(this).siblings('div.popup').show();" onmouseout="$(this).siblings('div.popup').hide();"><button class="span-4 button middle_gray_button">Edit Resource</button></div><div class="popup" style="height:50px; left:350px; width:270px; top:60px;"><img style="left:10px;" src="{{ MEDIA_URL }}images/adv_search_pfeil.png" />&nbsp;You don&rsquo;t have the permission to edit this resource.</div>
  {% endif %}
  <div style="clear: both;"></div>
  
  <p><input type="checkbox" name="choose_view" onClick="displayOptional();"> Only show mandatory fields</p>

</div>

{% include "repository/recomm_view.html" %}

{% endblock %}
